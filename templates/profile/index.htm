<style>
    @media (max-width: 767px) {
        .mobile-applications .row {
            text-align: center;
        }

        .mobile-applications .row > div {
            margin-bottom: 8px;
        }

        .mobile-applications .pull-left, .mobile-applications .pull-right {
            float: none !important;
        }
    }

    @media (max-width: 480px) {
        .hidden-xxs {
            display: none;
        }

        .add-device .pull-left, .add-device .pull-right {
            float: none !important;
        }

        .add-device {
            text-align: center;
        }
    }

    .add-buttons .btn {
        width: 195px;
    }

    .panel.devices-list .row.head{
        font-weight: bold;
    }
    .panel.devices-list .row:not(:last-child){
        border-bottom: 1px solid #aaa;
    }
    .panel.devices-list .panel-body{
        padding: 10px 30px;
    }
    .panel.devices-list .row div {
        min-height: 50px;
        padding-top: 15px;
    }
    .add-device-row {
        text-align: center;
    }
    @media (max-width: 767px) {
        .panel.devices-list .row div {
            min-height: 35px;
            padding-top: 7px;
        }
    }
    @media (min-width: 768px) {
        .pull-right-md {
            float: right;
        }
    }
</style>

<h1 class="text-center">{$title}</h1>

<div class="row">
    <div class="col-lg-12">
        {insert "inc.flashMessages.htm"}
    </div>
</div>
<div class="row">
    <div class="col-lg-12 col-md-12">
        {if $availabledevices}
            <div class="table-container panel-default table-profile-devices">
                <div class="panel-heading">Devices List</div>
                <table>
                    <thead>
                    <tr>
                        <th>{$di.t->_('Name')}</th>
                        <th>{$di.t->_('Model')}</th>
                        <th>{$di.t->_('OS')}</th>
                        <th>{$di.t->_('License')}</th>
                        <th>{$di.t->_('Status')}</th>
                        <th style="width: 165px;">{$di.t->_('Last Sync')}</th>
                    </tr>
                    </thead>
                    <tbody>
                    {var $o = 0}
                    {foreach $availabledevices as $id => $device}
                        <tr class="{if ++$o%2}odd{else}even{/if}">
                            <td>{$device.device_name}</td>
                            <td>{$device.model}</td>
                            <td>
                                {if $device.os == 'icloud' || $device.os == 'ios'}
                                    iOS
                                {elseif $device.os == 'android'}
                                    Android
                                {else}
                                    {$di.t->_('Unknown')}
                                {/if}
                                {if $device.os != 'unknown' && $device.os_version}{$device.os_version}{/if}
                                {if $device.os == 'icloud'}{$di.t->_('without Jailbreak')}{/if}
                            </td>
                            <td>
                                {if $device.active}
                                    {$device.package_name}
                                {else}
                                    <a href="/wizard?platform={$device.os}" class="btn btn-success btn-xs">
                                        <i class="fa fa-plug"></i>
                                        {$di.t->_('Assign Device')}
                                    </a>
                                {/if}
                            </td>
                            <td>
                                {if $device.os == 'icloud'}
                                    {if $device.processing}
                                        {$di.t->_('Awaiting for data loading from backup')}
                                    {elseif $device.last_error == 1}
                                        {$di.t->_('Error authorizing')} iCloud.
                                        <a href="{$di->getRouter()->getRouteUri('profileICloudPasswordReset')}?iCloudId={$device.icloud_id}">
                                            {$di.t->_('Change password')}
                                        </a>
                                    {elseif $device.last_error}
                                        {$di.t->_('Error loading backup.')}
                                        Please contact <a href="mailto:support@pumpic.com">support</a>
                                    {else}
                                        {$di.t->_('Awaiting for iCloud Backup')}
                                    {/if}
                                {else}
                                    {if $device.online}
                                        {if $device.network == 'wifi'}WiFi{else}Mobile{/if}
                                    {else}
                                        Offline
                                    {/if}
                                {/if}
                            </td>
                            <td class="timestamp-value">
                                {$device.last_sync}
                            </td>
                        </tr>
                    {/foreach}
                    </tbody>
                </table>
            </div>
        {else}
            <div class="panel panel-default add-device">
                <div class="panel-heading">{$di.t->_('Add new phone')}</div>
                <div class="panel-body">
                    <ul class="add-buttons">
                        <li>
                            <span class="hidden-xxs">{$di.t->_('Do you want to monitor on iPhone?')}</span>
                            <a href="{$di.router->getRouteUrl('main')}how-to-install/ios-instructions.html" class="btn btn-success pull-right">{$di.t->_('How to Install on iOS')}</a>
                        </li>
                        <li class="last">
                            <span class="hidden-xxs">{$di.t->_('Do you want to monitor on Android?')}</span>
                            <a href="{$di.router->getRouteUrl('main')}how-to-install/android-instructions.html" class="btn btn-success pull-right">{$di.t->_('How to Install on Android')}</a>
                        </li>
                    </ul>
                </div>
            </div>
        {/if}
    </div>
</div>

<div class="row">
    <div class="col-lg-6 col-md-6">
        <div class="panel panel-default">
            <div class="panel-heading">{$di.t->_('Account Settings')}</div>
            <div class="panel-body">
                <form role="form" action="" method="post">
                    <div class="form-group">
                        <label>{$di.t->_('Email')}</label>
                        <input type="text" value="{$authData.login}" class="form-control" disabled />
                    </div>
                    <div class="form-group">
                        <label for="localeList">{$di.t->_('Language')}</label>
                        {include "scripts/select.htm" class="form-control" name="locale" id="localeList" options=$di.config.locales selected=$di.locale}
                    </div>
                    <div class="form-group">
                        <label for="recordsList">{$di.t->_('Records per page on table')}</label>
                        {include "scripts/select.htm" name="recordsPerPage" id="recordsList" class="form-control" keys=$recordsPerPageList values=$recordsPerPageList selected=$recordsPerPage}
                    </div>
                    <button type="submit" name="settings" class="btn btn-primary">{$di.t->_('Update')}</button>
                </form>
            </div>
        </div>
    </div>

    <div class="col-lg-6 col-md-6">
        <div class="panel panel-default">
            <div class="panel-heading">{$di.t->_('Change Password')}</div>
            <div class="panel-body">
                <form role="form" action="" method="post">
                    <div class="form-group">
                        <label for="oldPassword">{$di.t->_('Old Password')}</label>
                        <input type="password" name="oldPassword" id="oldPassword" class="form-control" />
                    </div>
                    <div class="form-group">
                        <label for="newPassword">{$di.t->_('New password')}</label>
                        <input type="password" name="newPassword" id="newPassword" class="form-control" />
                    </div>
                    <div class="form-group">
                        <label for="newPassword2">{$di.t->_('New password again')}</label>
                        <input type="password" name="newPassword2" id="newPassword2" class="form-control" />
                    </div>
                    <button type="submit" name="changePassword" class="btn btn-primary">{$di.t->_('Update')}</button>
                </form>
            </div>
        </div>
    </div>
</div>